<!-- search.wxml -->
<view class="search-container">
  <!-- 搜索栏 -->
  <view class="search-bar">
    <view class="search-input">
      <icon type="search" size="16" color="#999" style="margin-right: 10rpx;"/>
      <input type="text" placeholder="搜索地点或机位标签" value="{{keyword}}" bindinput="onSearchInput" bindconfirm="onSearch"/>
    </view>
    <view class="filter-btn" bindtap="showFilters">
      <icon type="filter" size="20" color="#333"/>
    </view>
  </view>

  <!-- 筛选条件显示 -->
  <view class="filter-tags" wx:if="{{filters.types.length > 0 || filters.distance || filters.rating > 0}}">
    <block wx:if="{{filters.distance}}">
      <view class="filter-tag">按距离排序 <icon type="clear" size="14" color="#999" bindtap="removeFilter" data-type="distance"/></view>
    </block>
    <block wx:if="{{filters.rating > 0}}">
      <view class="filter-tag">{{filters.rating}}分及以上 <icon type="clear" size="14" color="#999" bindtap="removeFilter" data-type="rating"/></view>
    </block>
    <block wx:for="{{filters.types}}" wx:key="*this">
      <view class="filter-tag">{{item === 'architecture' ? '建筑' : item === 'nature' ? '自然' : item === 'portrait' ? '人像' : item === 'night' ? '夜景' : '日出日落'}} <icon type="clear" size="14" color="#999" bindtap="removeFilter" data-type="type" data-value="{{item}}"/></view>
    </block>
    <view class="filter-tag clear-all" bindtap="clearAllFilters">清除全部</view>
  </view>

  <!-- 选项卡 -->
  <view class="tabs">
    <view class="tab {{activeTab === 'hot' ? 'active' : ''}}" bindtap="switchTab" data-tab="hot">热门机位</view>
    <view class="tab {{activeTab === 'latest' ? 'active' : ''}}" bindtap="switchTab" data-tab="latest">最新发布</view>
  </view>

  <!-- 搜索结果列表 -->
  <view class="results-list">
    <block wx:if="{{!loading && (results[activeTab].length === 0)}}">
      <view class="empty-state">
        <icon type="search" size="60" color="#ccc"/>
        <text>暂无相关机位</text>
        <text style="font-size: 24rpx; color: #999; margin-top: 10rpx; display: block;">试试其他关键词或筛选条件</text>
      </view>
    </block>
    
    <block wx:elif="{{loading}}">
      <view class="loading-state">
        <text>搜索中...</text>
      </view>
    </block>
    
    <block wx:else>
      <view wx:for="{{results[activeTab]}}" wx:key="id" class="result-item" bindtap="onItemTap" data-id="{{item.id}}">
        <image class="result-image" src="{{item.image}}" mode="aspectFill"/>
        <view class="result-info">
          <view class="result-title">{{item.name}}</view>
          <view class="result-location">
            <icon type="location" size="14" color="#999"/>
            <text>{{item.location}}</text>
          </view>
          <view class="result-tags">
            <view class="tag">{{item.type === 'architecture' ? '建筑' : item.type === 'nature' ? '自然' : item.type === 'portrait' ? '人像' : item.type === 'night' ? '夜景' : '日出日落'}}</view>
            <view class="tag">{{item.distance}}</view>
          </view>
          <view class="result-stats">
            <view class="stat-item">
              <icon type="star" size="14" color="#999"/>
              <text>{{item.favorites}}</text>
            </view>
            <view class="stat-item">
              <icon type="location" size="14" color="#999"/>
              <text>{{item.checkins}}</text>
            </view>
          </view>
        </view>
      </view>
    </block>
  </view>

  <!-- 加载更多 -->
  <view class="load-more" wx:if="{{hasMore && !loading}}">
    <text>上拉加载更多</text>
  </view>
</view>